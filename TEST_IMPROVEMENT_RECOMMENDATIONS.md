# üß™ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Ç–µ—Å—Ç–æ–≤

## üìä –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ:
- **Allure –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –æ—Ç–ª–∏—á–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ `@Epic`, `@Feature`, `@Story`, `@DisplayName`, `@Description`, `@Severity`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `@ParameterizedTest` –∏ `@ValueSource`
- **–ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - Given-When-Then –ø–æ–¥—Ö–æ–¥
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –æ—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ –∏–∑ Telegram

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** - –º–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —à–∞–≥–æ–≤
2. **–•–∞—Ä–¥–∫–æ–¥ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ç–µ—Å—Ç–∞–º
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ @Step –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π** - –Ω–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–±—â–∏—Ö —à–∞–≥–æ–≤
4. **–ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ—Å—Ç—ã –¥–ª—è `likedOnly` –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
5. **–°–º–µ—à–∞–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** - —Ç–µ—Å—Ç—ã –¥–µ–ª–∞—é—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ

## üöÄ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. Test Data Builder Pattern
**–§–∞–π–ª:** `src/test/java/com/example/sticker_art_gallery/testdata/TestDataBuilder.java`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –õ–µ–≥–∫–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```java
// –í–º–µ—Å—Ç–æ:
CreateStickerSetDto dto = new CreateStickerSetDto();
dto.setName("test_stickers");

// –ò—Å–ø–æ–ª—å–∑—É–µ–º:
CreateStickerSetDto dto = TestDataBuilder.createBasicStickerSetDto();
```

### 2. Test Steps —Å @Step –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
**–§–∞–π–ª:** `src/test/java/com/example/sticker_art_gallery/teststeps/StickerSetTestSteps.java`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–∏—Ö —à–∞–≥–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ @Step –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è Allure –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```java
@Step("–°–æ–∑–¥–∞—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç —á–µ—Ä–µ–∑ API")
public ResultActions createStickerSet(CreateStickerSetDto createDto, String initData) throws Exception {
    return mockMvc.perform(post("/api/stickersets")
                    .header("X-Telegram-Init-Data", initData)
                    .header("X-Telegram-Bot-Name", TestDataBuilder.BOT_NAME)
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(objectMapper.writeValueAsString(createDto)));
}
```

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
**–§–∞–π–ª:** `src/test/java/com/example/sticker_art_gallery/controller/ImprovedStickerSetControllerIntegrationTest.java`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TestDataBuilder –∏ TestSteps
- ‚úÖ –ë–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –õ—É—á—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 4. –¢–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
**–§–∞–π–ª:** `src/test/java/com/example/sticker_art_gallery/controller/StickerSetLikedFilterIntegrationTest.java`

**–ü–æ–∫—Ä—ã–≤–∞–µ—Ç:**
- ‚úÖ `GET /api/stickersets?likedOnly=true`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è likedOnly
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –ª–∞–π–∫–∞–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—è `isLikedByCurrentUser`

### 5. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
**–§–∞–π–ª:** `src/test/java/com/example/sticker_art_gallery/testconfig/TestConfig.java`

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- ‚úÖ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

## üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –°–æ–∑–¥–∞—Ç—å Page Object Model –¥–ª—è API —Ç–µ—Å—Ç–æ–≤
```java
public class StickerSetApiPage {
    private final MockMvc mockMvc;
    private final ObjectMapper objectMapper;
    
    public StickerSetApiPage(MockMvc mockMvc, ObjectMapper objectMapper) {
        this.mockMvc = mockMvc;
        this.objectMapper = objectMapper;
    }
    
    public ResultActions createStickerSet(CreateStickerSetDto dto, String initData) throws Exception {
        return mockMvc.perform(post("/api/stickersets")
                .header("X-Telegram-Init-Data", initData)
                .header("X-Telegram-Bot-Name", "StickerGallery")
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(dto)));
    }
    
    public ResultActions getAllStickerSets(String initData) throws Exception {
        return mockMvc.perform(get("/api/stickersets")
                .header("X-Telegram-Init-Data", initData)
                .header("X-Telegram-Bot-Name", "StickerGallery"));
    }
}
```

### 2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Like API
```java
@Test
@DisplayName("POST /api/likes/stickersets/{id} –¥–æ–ª–∂–µ–Ω —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫")
void likeStickerSet_ShouldAddLike() throws Exception {
    // Given
    Long stickerSetId = createTestStickerSet();
    
    // When
    ResultActions result = mockMvc.perform(post("/api/likes/stickersets/" + stickerSetId)
            .header("X-Telegram-Init-Data", validInitData)
            .header("X-Telegram-Bot-Name", BOT_NAME));
    
    // Then
    result.andExpect(status().isOk())
            .andExpect(jsonPath("$.id").exists())
            .andExpect(jsonPath("$.userId").value(TEST_USER_ID))
            .andExpect(jsonPath("$.stickerSetId").value(stickerSetId));
}
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```java
@ParameterizedTest
@ValueSource(strings = {"", "invalid-name!", "name with spaces", "name@with#special$chars"})
@DisplayName("POST /api/stickersets —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 400")
void createStickerSet_WithInvalidNames_ShouldReturn400(String invalidName) throws Exception {
    // Given
    CreateStickerSetDto createDto = TestDataBuilder.createInvalidStickerSetDto(invalidName);
    
    // When
    ResultActions result = testSteps.createStickerSet(createDto, validInitData);
    
    // Then
    testSteps.verifyValidationError(result);
}
```

### 4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```java
@Test
@DisplayName("GET /api/stickersets –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ —Ä–∞–∑—É–º–Ω–æ–µ –≤—Ä–µ–º—è")
void getAllStickerSets_ShouldRespondInReasonableTime() throws Exception {
    // Given
    long startTime = System.currentTimeMillis();
    
    // When
    ResultActions result = testSteps.getAllStickerSets(validInitData);
    
    // Then
    long duration = System.currentTimeMillis() - startTime;
    assertThat(duration).isLessThan(2000); // –ú–µ–Ω–µ–µ 2 —Å–µ–∫—É–Ω–¥
    
    result.andExpect(status().isOk());
}
```

### 5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```java
@Test
@DisplayName("POST /api/stickersets —Å SQL –∏–Ω—ä–µ–∫—Ü–∏–µ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–µ–Ω")
void createStickerSet_WithSqlInjection_ShouldBeSafe() throws Exception {
    // Given
    CreateStickerSetDto createDto = TestDataBuilder.createInvalidStickerSetDto("'; DROP TABLE stickersets; --");
    
    // When
    ResultActions result = testSteps.createStickerSet(createDto, validInitData);
    
    // Then
    testSteps.verifyValidationError(result);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞
    assertThat(stickerSetRepository.count()).isGreaterThan(0);
}
```

## üéØ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å TestDataBuilder
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å TestSteps
3. ‚úÖ –°–æ–∑–¥–∞—Ç—å —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
4. üîÑ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã

### –≠—Ç–∞–ø 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
1. ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è likedOnly —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
2. üîÑ –¢–µ—Å—Ç—ã –¥–ª—è Like API
3. üîÑ –¢–µ—Å—Ç—ã –¥–ª—è Category API
4. üîÑ –¢–µ—Å—Ç—ã –¥–ª—è User API

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
1. üîÑ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
2. üîÑ –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. üîÑ –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. üîÑ –¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|----|----|-----------|
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | ~40% | ~10% | -75% |
| –í—Ä–µ–º—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–∞ | 15 –º–∏–Ω | 5 –º–∏–Ω | -67% |
| –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | +100% |
| –ü–æ–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π | 0% | 90% | +90% |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ—Å—Ç–æ–≤ | –°–ª–æ–∂–Ω–∞—è | –ü—Ä–æ—Å—Ç–∞—è | +200% |

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

1. **TestContainers** - –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
2. **WireMock** - –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö API
3. **Allure Reports** - –¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
4. **JaCoCo** - –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
5. **TestNG** - –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤:
- ‚úÖ –£–º–µ–Ω—å—à–∞—é—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ –£–ª—É—á—à–∞—é—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
- ‚úÖ –£–ø—Ä–æ—â–∞—é—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É
- ‚úÖ –î–æ–±–∞–≤–ª—è—é—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –°–æ–∑–¥–∞—é—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ø–æ –º–µ—Ä–µ —Ä–∞–∑–≤–∏—Ç–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.
