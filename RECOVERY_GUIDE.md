# üî¥ –ö–†–ò–¢–ò–ß–ù–û: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

## –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç `StickerSetUserIdFilterIntegrationTest` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `deleteAll()` –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —É–¥–∞–ª–µ–Ω–∏—é –≤—Å–µ—Ö —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ –∏–∑ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

## –í–∞—Ä–∏–∞–Ω—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. PostgreSQL Point-in-Time Recovery (PITR)
–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω WAL (Write-Ahead Logging) –∏ –µ—Å—Ç—å –±—ç–∫–∞–ø—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –±—ç–∫–∞–ø–æ–≤
ls -la /var/lib/postgresql/backups/
ls -la /var/backups/postgresql/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
pg_restore -d mindbase -U dalek backup_file.dump
```

### 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL
psql -U dalek -d mindbase -c "SHOW wal_level;"
psql -U dalek -d mindbase -c "SHOW archive_mode;"

# –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω, –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ –º–æ–º–µ–Ω—Ç–∞ –¥–æ —É–¥–∞–ª–µ–Ω–∏—è
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - —Ç–∞–º –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram Bot API - –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ –∏–º–µ–Ω–∞–º —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫—ç—à Redis (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è)

### 4. –†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
–ï—Å–ª–∏ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ (–∏–∑ –ª–æ–≥–æ–≤, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤):

```sql
-- –ü—Ä–∏–º–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞
INSERT INTO stickersets (user_id, title, name, is_public, is_blocked, is_official, created_at, updated_at)
VALUES (123456789, '–ù–∞–∑–≤–∞–Ω–∏–µ', 'name_by_StickerGalleryBot', true, false, false, NOW(), NOW());
```

## –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã** - —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥–∞–ª—å–Ω–µ–π—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–Ω–∏–º–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î**:
   ```bash
   pg_dump -U dalek -d mindbase > backup_before_recovery_$(date +%Y%m%d_%H%M%S).sql
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
4. **–°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –ë–î** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ

‚úÖ –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω:
- –î–æ–±–∞–≤–ª–µ–Ω—ã `@Transactional` –∏ `@Rollback`
- `deleteAll()` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –∏–º–µ–Ω–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

## –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤ –±—É–¥—É—â–µ–º

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
2. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Transactional` –∏ `@Rollback`** –≤ —Ç–µ—Å—Ç–∞—Ö
3. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –æ–∫—Ä—É–∂–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ö–µ–º—É –ë–î** –¥–ª—è —Ç–µ—Å—Ç–æ–≤


